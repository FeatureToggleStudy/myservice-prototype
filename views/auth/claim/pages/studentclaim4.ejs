<!DOCTYPE html>
<html class="js" lang="en">

<head>
  <meta charset="utf-8">
  <meta content="width=device-width" name="viewport">
  <title>Student Claim</title>
  <link href="/css/main.css" rel="stylesheet">
  <style>
    .pt-flow--veteran,
    .pt-flow--student,
    .pt-flow--claimant {
      display: none;
    }

    .hide-fields>div {
      display: none;
    }
  </style>
</head>

<body class="uikit-body uikit-grid uikit-refactor">
  <noscript>
    <p role="alert">This website needs JavaScript to work properly.</p>
  </noscript>
  <nav class="uikit-skip-link">
    <a class="uikit-skip-link__link" href="#main-content">Skip to main content</a>
  </nav>
  <% include ../../../global/partials/header-topbar.ejs %>
    <% include ../../../global/partials/header-claims.ejs %>

        <main>
          <div class="container" id="main-content">

            <h1 id="question_pageheaderFinancial"></h1>

            <div class="form-group uikit-page-alerts uikit-page-alerts--warning pt-flow--student pt-studentFinancialPermission" id="question_message15">

            </div>

            <div class="row">

              <fieldset class="hide-fields grids col-sm-7">
                <!-- 28 a -->

                <div class="form-group pt-flow--student pt-flow--claimant pt-flow--veteran">
                  <h3 class="margin-above margin-above--none margin-below margin-below--none" id="question_id51"></h3>


                  <fieldset>
                    <!-- Account name -->
                    <div class="form-group">
                      <label class="uikit-text-input__label" for="account-name" id="question_id29"> </label>
                      <input class="uikit-text-input" name="account-name" id="account-name" type="text" value="" required="" aria-required="true" style="max-width: 22em;">
                    </div>

                    <!-- BSB -->
                    <div class="form-group">
                      <label class="uikit-text-input__label" for="bsb" id="question_id30">
                      </label>
                      <input class="uikit-text-input bsb" type="text" name="bsb" id="bsb" maxlength="3" required="" aria-required="true" aria-label="3 digit BSB"> -
                      <input class="uikit-text-input bsb" type="text" name="bsb" id="bsb" maxlength="3" required="" aria-required="true" aria-label="3 digit BSB">
                    </div>

                    <div>
                      <!-- <div class="loading"></div> -->
                      <h3 class="labeltext margin-below--none">Financial institution</h3>
                      <p>// Bank name appears here </p>
                    </div>

                    <!-- Account number -->
                    <div class="form-group margin-below--none">
                      <label class="uikit-text-input__label" for="account-number" id="question_id31"> </label>
                      <input class="uikit-text-input" name="account-number" id="account-number" type="number" value="" required="" aria-required="true" style="max-width: 22em;">
                    </div>


                </div>

                <div class="pt-flow--student pt-flow--claimant pt-flow--veteran pt-showIfStudentBetween16and18">
                  <!--   -->
                  <div class="form-group">
                    <fieldset>
                      <h3 class="margin-below margin-below--mid" id="question_id52"></h3>

                      <legend class="legend-label" id="question_id55"></legend>
                      <div class="radio-toggle">
                        <label class="on label-left ">
                          <input type="radio" name="doesStudentHaveTFN" value="yes">
                          <span>Yes</span>
                        </label>
                        <label class="off label-right ">
                          <input type="radio" name="doesStudentHaveTFN" value="no">
                          <span>No</span>
                        </label>
                      </div>
                    </fieldset>
                  </div>

                  <div class="form-group uikit-page-alerts uikit-page-alerts--alert pt-showIfNoStudentTFN" id="question_message16">

                  </div>



                  <div class="form-group pt-showIfStudentTFN">
                    <div class="form-group">
                      <label class="uikit-text-input__label" for="tfn" id="question_id55a">

                      </label>
                      <input class="uikit-text-input input-half" name="tax-file-number" id="tax-file-number" type="number" value="" required="" aria-required="true">
                    </div>

                    <div class="form-group uikit-page-alerts uikit-page-alerts--alert" id="question_message17">

                    </div>



                    <div class="form-group pt-educationAllowanceTaxed">
                      <fieldset>
                        <legend class="legend-label" id="question_id53"> </legend>
                        <div class="radio-toggle">
                          <label class="on label-left">
                            <input type="radio" name="educationAllowanceTaxed" value="yes">
                            <span>Yes</span>
                          </label>
                          <label class="off label-right">
                            <input type="radio" name="educationAllowanceTaxed" value="no">
                            <span>No</span>
                          </label>
                        </div>
                      </fieldset>
                    </div>

                    <div class="form-group pt-showIfEducationAllowanceTaxed">
                      <fieldset>
                        <legend class="legend-label" id="question_id54"></legend>
                        <span class="input-support-text">$</span>
                        <input class="uikit-text-input input-small yyyy" name="howMuchTax" id="howMuchTax" type="number">
                        <span class="input-support-text input-support-text--middle">or </span>
                        <input class="uikit-text-input input-small yyyy" name="howMuchTax" id="howMuchTax" type="number">
                        <span class="input-support-text">%</span>
                      </fieldset>
                    </div>

                    <div class="form-group uikit-page-alerts uikit-page-alerts--alert pt-showIfEducationAllowanceNotTaxed" id="question_message18">
                    </div>

                  </div>
                </div>


                </fieldset>

                <% include ../partials/uploads-shopping-cart.ejs %>

            </div>
            <div class="pagination pagination--ss-reverse-order">
              <button class="uikit-btn uikit-btn--tertiary " onclick="javascript:history.back() ">Previous</button>
              <button class="uikit-btn uikit-btn--tertiary " onclick="window.location.href='#open-modal' ">Cancel claim</button>
              <div class="floated ">
                <button class="uikit-btn uikit-btn--tertiary " onclick="window.location.href='/auth/index-claims' ">Save and exit</button>
                <button class="uikit-btn btnNext " onclick="window.location.href='/auth/claim/pages/studentclaim4a' ">Save and next</button>
              </div>
            </div>
            <% include ../partials/cancel-modal.ejs %>
          </div>

        </main>

        <% include ../../../global/partials/footer.ejs %>
          <script src="/js/students.js "></script>
          <script>
            $(document).ready(function () {
              let age = localStorage.getItem('studentAge');
              console.debug('in studentclaim4 - age: ', age);
              if (age && age >= 18) {
                $(".pt-tfnClaimantStudent").show();
                $(".pt-tfnClaimantStudent").removeClass('display-none');
                $(".tfn-group").removeClass('display-none');
              }
            });
          </script>
<script>
$(document).ready(function() {
  initStudents();
  initFlow();

  window.Person = function() {
    // how many times is the called
    this.i = 0;

    this.studentAge;
    this.studentNameFirst;
    this.docsRequired = [];

    // privileged init method
    this.init();
  }

  // defining init method
  Person.prototype.init = function () {
    // reassign this
    var _this = this;
    _this.checkDocs();
    setInterval(function () {
      _this.checkDocs();
    }, 1500);
  }

  Person.prototype.checkDocs = function () {
    this.i++;

    // check type of person 
    if (("studentFlow" in localStorage) || ("veteranFlow" in localStorage) || ("claimantFlow" in localStorage)) {

      if ("studentFlow" in localStorage) {
        this.type = 'student';
      } else if ("veteranFlow" in localStorage) {
        this.type = 'veteran';
      } else if ("claimantFlow" in localStorage) {
        this.type = 'claimant';
      }
    }

    // Proof of relationship 
    if ("veteranFlow" in localStorage) {
      if ((localStorage.getItem('studentNameFirst') !== null) && (localStorage.getItem('studentNameLast') !== null)) {
        initStudents();
        this.docsRequired.indexOf("proofOfRelationshipClaimantStudent") === -1 ? this.docsRequired.push("proofOfRelationshipClaimantStudent") : console.log();
      } else {
        var i = this.docsRequired.indexOf("proofOfRelationshipClaimantStudent");
        if (i != -1) {
          this.docsRequired.splice(i, 1);
          $('.pt-proofOfRelationshipClaimantStudent').addClass('display-none');
        }
      }
    } else if ("studentFlow" in localStorage) {
      if ((localStorage.getItem('veteranNameFirst') !== null) && (localStorage.getItem('veteranNameLast') !== null)) {
        this.docsRequired.indexOf("proofOfRelationship") === -1 ? this.docsRequired.push("proofOfRelationship") : console.log();
      } else {
        var i = this.docsRequired.indexOf("proofOfRelationship");
        if (i != -1) {
          this.docsRequired.splice(i, 1);
          $('.pt-proofOfRelationship').addClass('display-none');
        }
      }
    } else if ("claimantFlow" in localStorage) {
      if ((localStorage.getItem('veteranNameFirst') !== null) && (localStorage.getItem('veteranNameLast') !== null) && (localStorage.getItem('studentNameFirst') !== null) && (localStorage.getItem('studentNameLast') !== null)) {
        initStudents();
        if ((localStorage.getItem('veteranNameFirst') !== null) && (localStorage.getItem('veteranNameLast') !== null)) {
          this.docsRequired.indexOf("proofOfRelationshipVeteranStudent") === -1 ? this.docsRequired.push("proofOfRelationshipVeteranStudent") : console.log();
        } else {
          var i = this.docsRequired.indexOf("proofOfRelationshipVeteranStudent");
          if (i != -1) {
            this.docsRequired.splice(i, 1);
            $('.pt-proofOfRelationshipVeteranStudent').addClass('display-none');
          }
        }

        if ((localStorage.getItem('studentNameFirst') !== null) && (localStorage.getItem('studentNameLast') !== null)) {
          this.docsRequired.indexOf("proofOfRelationshipClaimantStudent") === -1 ? this.docsRequired.push("proofOfRelationshipClaimantStudent") : console.log();
        } else {
          var i = this.docsRequired.indexOf("proofOfRelationshipClaimantStudent");
          if (i != -1) {
            this.docsRequired.splice(i, 1);
            $('.pt-proofOfRelationshipClaimantStudent').addClass('display-none');
          }
        }
      }
    }


    // Proof of enrolment 
    if ("enrolStatus" in localStorage) {
      this.docsRequired.indexOf("proofOfEnrolment") === -1 ? this.docsRequired.push("proofOfEnrolment") : console.log();
    } else {

      var i = this.docsRequired.indexOf("proofOfEnrolment");
      if (i != -1) {
        this.docsRequired.splice(i, 1);
        $('.pt-proofOfEnrolment').addClass('display-none');
      }
    }

    // Proof of residence 
    if (localStorage.getItem('studentLivingLocation') === 'away-from-home') {
      this.docsRequired.indexOf("proofOfResidence") === -1 ? this.docsRequired.push("proofOfResidence") : console.log();
    } else {
      var i = this.docsRequired.indexOf("proofOfResidence");
      if (i != -1) {
        this.docsRequired.splice(i, 1);
        $('.pt-proofOfResidence').addClass('display-none');
      }
    }

    // Part-time study reason 
    if ((localStorage.getItem('studentLoadOfStudy') === 'part-time')) {
      this.docsRequired.indexOf("partTimeStudyReason") === -1 ? this.docsRequired.push("partTimeStudyReason") : console.log();
    } else {
      var i = this.docsRequired.indexOf("partTimeStudyReason");
      if (i != -1) {
        this.docsRequired.splice(i, 1);
        $('.pt-partTimeStudyReason').addClass('display-none');
      }
    }

    // show all required docs 
    if (this.docsRequired.length > 0) {
      jQuery(".pt-showIfDocumentUploadShoppingCart").show();
      $.each(this.docsRequired, function () {
        $('.pt-' + this).removeClass('display-none');
      });
    }
  };

  // create a new person
  var counter = new Person();

  $('.pt-studentAge--mature').hide();
  $('.pt-showIfEducationAllowanceTaxed').hide();
  $('.pt-showIfEducationAllowanceNotTaxed').hide();
  $('.pt-showIfCarePercentageLow').hide();
  $('.pt-showIfCarePercentageHigh').hide();
  $('.bank-details-container').hide();
  $('.pt-showIfNoStudentTFN').hide();
  $('.pt-showIfStudentTFN').hide();
  $('.pt-studentFinancialPermission').hide();

  // if student 16 or 17 ask for TFN
  if (("claimantFlow" in localStorage) || ("veteranFlow" in localStorage)) {
    if ((localStorage.getItem('studentAge') <= 18) && (localStorage.getItem('studentAge') > 15)) {
      $(".pt-showIfStudentBetween16and18").show();

    } else {
      $(".pt-showIfStudentBetween16and18").hide();
    }
  }

  if (("studentFlow" in localStorage)) {
    if ((localStorage.getItem('studentAge') < 18) && (localStorage.getItem('studentAge') > 15)) {
      $('.pt-studentFinancialPermission').show();
    }
  }

  if (localStorage.getItem('studentAge') > 15) {
    $('.pt-studentAge--mature').show();
  }

  $('input[name=educationAllowanceTaxed]').change(function () {
    if ($('input[name=educationAllowanceTaxed]:checked').val() === 'yes') {
      $(".pt-showIfEducationAllowanceTaxed").show();
      $('.pt-showIfEducationAllowanceNotTaxed').hide();
    } else {
      $(".pt-showIfEducationAllowanceTaxed").hide();
      $('.pt-showIfEducationAllowanceNotTaxed').show('fast');
    }
  });

  // bank details button function
  $("#btnAddBank").click(function () {
    $(".bank-details-container").show("fast");
    $("#btnAddBank-box").hide();
    $("#bankoptional").hide();
    $("#btnCancelBank").show();
    $("#bank-name").focus();
  });
  $("#btnCancelBank").click(function () {
    $(".bank-details-container").hide("fast");
    $("#btnCancelBank").hide();
    $("#bankoptional").show();
    $("#btnAddBank-box").show();
  });

  $(".message-close").click(function () {
    $(".bank-details-container").hide("fast");
  });

  $('input[name=doesStudentHaveTFN]').change(function () {
    if ($('input[name=doesStudentHaveTFN]:checked').val() === 'yes') {
      localStorage.setItem('studentTFN', true);
      $(".pt-showIfNoStudentTFN").hide();
      $(".pt-showIfStudentTFN").show();
    } else {
      localStorage.setItem('studentTFN', false);
      localStorage.removeItem('tfn');
      $(".pt-showIfNoStudentTFN").show('fast');
      $(".pt-showIfStudentTFN").hide();
    }
  });
});
</script>
</body>
</html>